---
applyTo: '**'
---

Provide project context and coding guidelines that AI should follow when generating code, answering questions, or reviewing changes.

#### Combat 模組目前有些事情還沒做:(但也不急著做)

## 關於分層的見解

- 我認為分層是基於依賴，下層不該依賴上層
- 我想到的是 infra,context,domain,logic,coordination,combat-engine

### 很急

- 從我的新構思來評估該如何重構 Combat 模組以及風險評估。
- 能夠使用裝備、大絕招、聖物、裝備特效等來改變傷害與狀態與異常狀態計算邏輯
- 回放系統(邏輯)
- 回放系統(UI)，但這個很麻煩，可能很考驗 UI/UX 不是我擅長的

### 不急

- 單元測試
- Try...Catch 錯誤處理
- 記憶體管理與效能優化(正式版前要處理)

### 需要確認

- src\modules\combat\infra\event-bus\combat.event.map.model.ts
  - CombatEventMap 我覺得可能每個事件都需要 payload interface
- src\modules\combat\domain\character\models\attribute.modifier.model.ts
  - ModifierPriority 暫時似乎沒用途，需要標記 TODO 或從遊戲機制剖析是否該保留。
- src\modules\combat\domain\character\interfaces\character.interface.ts
  - ICharacter 是否真的有實踐組合優於繼承的精神?
- src\modules\combat\domain\character\models\character.snapshot.model.ts
  - 這個檔案意義不明，character 內部沒有使用他，反而是快照功能有引用他。是否放錯位置？
- IUltimateOwner 這個東西，我還是搞不明白，在這個combat module 內 ultimate 到底被視為甚麼? 可以視為一種插拔物件嗎?(類似效果、裝備)?
