# Combat 模組

## 很急

- 當我們使用了大量 DI 與 介面之後開始發現constructor 參數過多
  - 我想要超過五個建構參數就開始考慮使用 Facade or Builder.
- 介面(需要被實作豐富類的)名稱通通 I開頭，儘管不符合我的最初想法，但為了語言轉換方便。這是必須的
- 新增限制:禁止使用全局單例(順便告訴我原因)
- 新增限制:每個目錄最多 10 個檔案
- 我發現 `character.ts` 裡面有一堆很醜的箭頭建構有些箭頭函數很醜的 DI這個也要改，類似的也要改

## 需要討論(暫時先不提及)

- 我目前代碼轉不可變純函數特性，TradeOffs下，假設轉換成本為0 因為是 AI 重構。
- 探討不可變純函數的遊戲管理機制用的語法以及特性
- 狀態分散在 Context + 各 Manager → 改用「純資料狀態 + 純函數系統」是否可行?

## 不急

- 引入領域錯誤 CombatError Extends Errors
- 導入 immer.js 實現不可變

## 未來統一實作

- 單元測試 (Jest)
- 錯誤處理 (Try...Catch)
  - 對每個模組評估是否該做 Exception 或者 純粹回傳 Result 型別
  - 這一塊有爭議，有人說戰鬥模組不應該有拋例外狀況
- 記憶體管理與效能優化
