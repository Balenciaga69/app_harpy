# 遊戲機制與設計大綱（2025/12/06）(新版未實踐)

## 遊戲核心概念

- 基於 RogueLite 概念，強化賭博、刺激、緊張。
- 玩家扮演一名貴族，在第一關選擇心儀的 Gladiator 在競技場戰鬥與決鬥之外的 Gladiator 管理與升級。

## 戰鬥系統

### 1. 攻擊邏輯

- 僅分「普通攻擊」與「大招」兩種，無元素或物理魔法傷害規則之分。
- 普通攻擊有 cooldown（等待時間，單位 tick），大招需能量條充滿後釋放，無 cooldown。
- 能量條由角色屬性決定獲取速度，並有自然回復。
- 傷害分為「一般傷害」與「真實傷害 True Damage」（無視任何減免）。
- 異常狀態（聖火、燃燒、中毒、充能等）獨立於元素屬性，並可被裝備、角色、聖物等影響。
- 閃避與減免機制自訂，簡化公式，避免複雜計算。

### 2. 戰鬥流程

- 具備裝備、大絕招、遺物等多元養成與策略選擇。
- Tick-based 自動戰鬥，玩家僅於戰前配置與選擇技能。
- 進入戰鬥後運算完，玩家實際上是在看運算後日誌的運行結果
- 玩家與敵人依據冷卻時間自動執行行動。(會附加隨機延遲)
- 戰鬥結果於載入時即決定，過程不可干預。
- 傷害流程為線性步驟：BeforeDamage → HitCheck → Critical → DamageModify → Defense → BeforeApply → Apply → AfterApply。
- 攻擊目標選擇支援策略模式(攻擊第一位、攻擊血最少、攻擊血最多等等)
- 重點行動都會塞入戰鬥日誌隊列

### 3. 異常狀態與效果

- 異常狀態機制目前還在構思，可能會大改動
- 聖火、充能、冰緩、毒等異常狀態有各自疊加、減少、觸發規則。
- 無屬性異常如致盲、破甲、出血、褻瀆等，影響命中、護甲、生命等。
- 部分裝備、聖物可改變異常狀態的計算方式或效果。

### 4.復活系統

- 被擊殺血量歸零進入死亡檢查
- 添加起死回生概率、復活後恢復多少%血量等機制。
- 復活後恢復多少%血量 下限 10% 上限 100%
- 起死回生概率 下限 3% 上限 50%
- 復活後異常狀態全部清除。

### 5.賽前變數

- 進入 CombatEngine 前會有(1~n)個賽前變數注入效果階段(決定戰前事件，事件結果將會以效果策略注入戰鬥模組中。)
- 這個效果通常會影響兩個人，例如開局皆受到 16層 Chill、復活率提升 20%，大招充能效率基數 x 30% 等等。

### 6.賽前博弈

- 你將可以下注自己至少剩餘多少 % 血量贏得比賽，如果猜對則獲得相對應賠率的金幣獎勵，猜錯則保持原本應得的金幣。(下限 1%,上限 100%)

## 角色與裝備系統

### 1. 屬性分層

- 防禦：HP、護甲（%減傷）、閃避（與命中值運算）。
- 攻擊：攻擊力、攻擊冷卻、暴擊率、命中值、攻擊標籤。
- 機制：大招充能效率、復活率等等。

### 2. 裝備分類與機制

- 武器、頭盔、裝甲、項鍊、鞋子...。等等(可能有很多種不同的，但每種類別一次只能穿一件)
- 真正運算 Combat 不用區分裝備是鞋子還是盔甲了，通通都是裝備導入計算效果而已。
- 其實本質上都是遺物(Items)，只不過遺物可以無限堆疊，但裝備武器只能裝備一個。
- 遺物與裝備物品可能改變遊戲玩法，所以需要複雜運算鍊。
- 裝備無升級系統，過時就該被淘汰，請購買新的。

## 關卡與進程

### 初步概述

- 關卡分一般、小型 Boss、大型 Boss、正面事件。
- 層數遞增，怪物屬性依難度係數調整。
- 最高 30 關，每 5 關有中型 Boss，每 10 關有大型 Boss。
- 超過 30 關，則進入無盡模式，難度持續提升。
- 每 10 關稱為一個「章節」，可以看到每個節點上的敵人。
- 章節提供三條或兩條路線選擇，路線影響敵人與事件類型。第 5 關與第 10 關為集中點必經 Boss 關卡。
- 房間分為 敵人、菁英敵人、事件三種
- 事件有: 純粹正面事件、一正一負兩種(發想中)。

## 掉落與商店

- 每關勝利後會掉落金幣。
- 金幣可以進入商店拉霸或水果機賭博
- 商店可隨時進入，拓過金幣購買物品。
- 物品價格被係數控制，隨關卡提升而通膨。
- 商店常駐在主頁面上，不用偶遇生成。

## 賭博

- 賭博可以獲得金錢或高價物(Jackpot)
- 賭博可以連鎖倍率樂賭越兇
- 賭博以老虎機或水果機為主(還在構思哪個比較好做)

## 失敗與重試

- 失敗與戰鬥中的復活與死亡不是同一個東西。
- 遊戲結束結果 -> 失敗，才是這區指名的失敗。
- 失敗後如果玩家持有某種道具，你將消耗該金幣克隆你的 角鬥士 。
- 商店老闆會幫你 Clone 一個 角鬥士 回來，並且給你一次賭博作為補償同時刷新商店內容。
- 否則直接進入本Run的Game Over狀態。
- 這遊戲沒那麼嚴格，其實允許玩家瘋狂 save & load

## 個人偏好命名

### 正面例子

- 我希望這遊戲特色是可移植的，如果這從競技場變成冒險依然適用
- 中性名稱: Player 玩家, Character 角色, Entity 實體, Creature 生物, Combat 戰鬥, Encounter 遭遇, Run 遊戲流程, Reward 獎勵, Equipment 裝備, Inventory 背包, Shop 商店, PersistentStorage 等等

### 反面例子

- 下列東西深度綁定在競技場與角鬥士的設定中，不適合用於未來可移植的遊戲機制中
- 角鬥士 Gladiator: 玩家操控的角色稱號
- 貴族 Noble: 玩家身份稱號
- 競技場 Arena: 戰鬥場景稱號

## 模組分割(初步構想而已，可以調整)

- [階段完工]CombatEngine: 戰鬥純粹運算回傳結果與日誌、武器效果等等運算都集中在此。
- [階段完工]Replay: 基於日誌與快照驅動的日誌控制邏輯
- [階段骨架建立]RunModule: 管理從第 1 層到第 n 層的完整流程，處理死亡、存檔、場景切換。
- Encounter: 生成敵人、商店、偶遇事件等等與路線三選一等等
- EquipmentModule: 生成裝備
- RewardModule: 負責生成獎勵物品、Reward, Loot 等等
- EventModule: 生成偶遇事件
- SlotMachine: 生成商店賭場
- CreatureModule: 生成戰鬥敵人、角色等等
- InventoryModule: 管理玩家背包
- ShopModule: 生成商店邏輯
- PersistentStorageModule: 存與讀檔案

## 初步開發構思發想(初步構想而已，可以調整)

- CombatEngine → Replay → RunModule → EncounterModule → Creature/Equipment/Reward → Shop/Inventory -> Gamble → PersistentStorage → EventModule
