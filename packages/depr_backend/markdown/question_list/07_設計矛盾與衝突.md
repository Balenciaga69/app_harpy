# 設計矛盾與衝突

## 1. 詞綴系統的靜態/動態矛盾 🔴

### 矛盾 A：靜態預綁定 vs 動態選擇

**affix.blueprint.md 強調：**

> 詞綴完全靜態預綁定、無動態選擇、無權重

**但 item.blueprint.md 提到：**

> 物品生成時需選擇詞綴組合

### 問題

如果詞綴無動態選擇，物品怎麼生成不同的詞綴組合？

```
矛盾流程：
1. Affix 系統說：預綁定，無選擇
2. Item 系統說：需要選擇 3 個詞綴
3. 誰負責選擇？
4. 有權重嗎？有池嗎？
```

### 標記

- **(過時)** 或 **(設計矛盾)** - 需要澄清

---

## 2. 詞綴附加的靜態/動態矛盾 ⚠️

### 矛盾 B：不關心持有者 vs 動態附加

**affix.blueprint.md 規定：**

> 詞綴不關心持有者或堆疊規則，由載體決定

**但 ultimate.blueprint.md 的附魔系統：**

> 允許動態附加詞綴到 Ultimate Gem

### 問題

- 詞綴應該靜態（預綁定）
- 還是動態可附加？

如果允許動態附加，那就不是「載體決定堆疊規則」

而是「Affix 系統動態管理附加」

### 案例

```
// Ultimate Gem 附魔
gem.attach(affix); // 動態添加

// 但這與「詞綴靜態」矛盾
// 若靜態，怎麼動態附加？
```

### 標記

- **(設計矛盾)** - 靜態 vs 動態需要明確

---

## 3. 屬性系統的元素隔離 ⚠️

### 矛盾 C：無元素區分 vs 元素異常狀態

**combat.blueprint.md 簡化：**

> 攻擊與技能簡化為普通攻擊與大招，無元素區分

**但 ailment.blueprint.md 提及：**

> 聖火、冰緩等屬性異常狀態

### 問題

異常狀態暗示需要元素機制

但戰鬥系統沒有定義元素系統

導致「異常狀態從何而來」不清

```
? 冰緩異常是哪個攻擊造成的？
? 普通攻擊？大招？都不是元素攻擊啊

? 聖火是怎麼觸發的？
? 如果都是普通攻擊，誰決定造成什麼元素？
```

### 標記

- **(缺陷)** - 需要補充元素系統或廢除元素狀態

---

## 4. 敵人模板的靜態/動態矛盾 🔴

### 矛盾 D：靜態模板 vs 特殊詞綴

**level.blueprint.md 規定：**

> 敵人模板靜態、無 rolled

**但 endless.blueprint.md 允許：**

> 敵人加入特殊詞綴

### 問題

特殊詞綴是動態附加的（無盡模式特定）

這與「敵人模板靜態」矛盾

```
// 無盡敵人
enemy = instantiate(enemyTemplate);
enemy.attach(specialAffix); // 動態添加

// 但模板說靜態...
// 這個特殊詞綴怎麼存檔？
// 它屬於敵人實例還是模板？
```

### 標記

- **(設計矛盾)** - 需要區分模板 vs 實例級 Affix

---

## 5. 賽前變數的靜態注入 ⚠️

### 矛盾 E：靜態模板 vs 動態變數

**pre-combat.blueprint.md 的賽前變數：**

> 以狀態或屬性修飾符注入

**但 affix.blueprint.md 限制：**

> 詞綴為靜態

### 問題

動態注入「違反設計原則」嗎？

還是這是特殊例外？

```
// 賽前變數
applyPreCombatBonus(unit, bonus); // 動態添加

// 但詞綴系統說靜態預綁定
// 這是不同的系統嗎？
// 還是同一套邏輯的不同應用？
```

### 標記

- **(設計模糊)** - 需要澄清賽前變數與靜態詞綴的關係

---

## 6. 交易系統的責任邊界 ⚠️

### 矛盾 F（過時）：內外責任分界

**shop.blueprint.md 強調：**

> 交易原子性由外部系統處理，本專案不負責

### 問題

這忽略了內部邏輯與外部依賴的整合風險

```
// 例
購買物品流程：
1. 檢查金幣（內部）
2. 調用外部支付系統
3. 更新金幣（內部）
4. 外部系統失敗了

如果外部失敗，內部已改狀態怎麼辦？
本專案說不負責？那誰負責回滾？
```

### 標記

- **(過時)** 可能需要重新設計

---

## 重點梳理

| 編號 | 矛盾                     | 類型     | 優先級 | 備註       |
| ---- | ------------------------ | -------- | ------ | ---------- |
| A    | 靜態預綁定 vs 動態選擇   | 詞綴系統 | 🔴 高  | 需澄清     |
| B    | 不關心持有者 vs 動態附加 | 詞綴系統 | 🔴 高  | 需明確     |
| C    | 無元素 vs 元素狀態       | 屬性系統 | 🟡 中  | 設計空白   |
| D    | 靜態模板 vs 特殊詞綴     | 敵人系統 | 🔴 高  | 分層不清   |
| E    | 靜態詞綴 vs 動態變數     | 賽前系統 | 🟡 中  | 需定義例外 |
| F    | 交易內外責任             | 商店系統 | 🟡 中  | 過時設計   |

---

## 標記

- 總體：需要優先解決 A, B, D 三個高優先級矛盾
- 方式：設計評審會議逐一確認
