## 商店（Shop）

### 主要功能

#### 購買

- 玩家可從商店購買物品。
- 購買時會觸發多個系統（如金幣扣除、物品加入倉庫）。

#### 出售

- 玩家可將物品賣給商店。
- 出售後會獲得金幣，並將物品從倉庫移除。

#### 商店刷新

- 商店可定時或手動刷新，產生新物品列表。
- 刷新可能需要消耗資源或金幣。

#### 狀態管理

- 商店需維護當前物品列表與狀態。
- 狀態包括已購買、已售出、可刷新等。

#### 定價系統

- 每個物品有基礎價格。
- 關卡難度提升時，物品價格會根據難度係數增加。
- 支援特價活動，部分物品可臨時降價。

#### 特價與促銷

- 商店可針對特定物品進行特價。
- 特價物品會有明顯標示，吸引玩家購買。

#### 物品生成器

- 商店是物品生成器的主要調用者。
- 每次刷新或初始化時，會請求物品生成器產生新物品。

---

### 商店不負責的內容

#### 金幣管理

- 商店本身不直接管理玩家金幣。
- 金幣的增減由其他系統處理。

#### 倉庫操作

- 商店不直接操作玩家倉庫。
- 物品的存取與移動由倉庫系統負責。

---

## 子系統：商店交易系統（Trade System）

### 交易協調

- 買賣行為涉及多個系統：
  - 商店生成物品
  - 倉庫存取
  - 金幣更新

### 防腐層（ACL）

- 交易系統作為防腐層，保護核心邏輯不受外部變動影響。
- 若買賣規則變更，只需修改交易系統，無需動核心邏輯。

### 交易流程

- 玩家發起買賣請求。
- 交易系統協調金幣、倉庫、商店三方操作。
- 完成交易後，回饋結果給玩家。
