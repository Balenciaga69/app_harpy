# Level（關卡）

## 語意級

### 關卡類型

- normal（普通戰）。
- elite（菁英戰，第5關固定）。
- boss（首領戰，第10關固定）。
- event（事件）。
- normal/event 節點依機率分布生成。
- 僅有單一路線，不產生分岔圖（非 Slay the Spire 類型）。

## 架構級

### 戰鬥節點（Combat Node）

- 依條件從敵人原型篩選敵人。
- 可附加難度參數（如技能、詞綴隨難度變化，而非僅數值提升）。
- 戰鬥前可預覽敵人數據，戰鬥中亦可能有變化。

### 敵人生成

- 敵人以模板（原型）定義。
- 模板屬性：ID、出現章節範圍、Stat、Affixes。
- 可否作為 Combat/Boss/Elite 對手等。
- 一個敵人模板可以同時擔任 normal/elite/boss 角色，根據生成參數決定具體配置（如技能變化）。
- 擔任菁英、首領、普通戰鬥時 Affixes 的配置完全靜態，無需 roll 或權重計算，規則寫在模板中。

### 事件生成

- 事件節點生成後，依不同權重選擇原型。
- 事件會根據玩家當前狀態調整權重（如金錢過多則給金錢消耗事件）。
- 事件原型屬性：id、出現章節、生成觸發條件、類型（道德選擇、風險獎勵等）、選項與文本。

## 代碼級

### 事件（Event）

- 事件為資料模板（Blueprint）+ 即時邏輯執行器。
- 事件原型表定義文本、選項、每選項對應的 ResultAction 陣列。
- 事件不具 HP、不可被攻擊或賦予狀態，僅為流程控制節點。
- 僅存在於玩家選擇 Event 節點到做出決策的期間。
- 選項結果（ResultAction）為核心系統橋樑，定義對 Run Context 的修改。

### 範例

- 花費所有金幣，獲得神龍之心。
- 嘗試與魔王鏡像對戰一次。
- 下場戰鬥獲得 30% 生命加成。

### 設計原則

- 請遵循「代碼無狀態、功能解耦」原則，事件僅為流程控制節點，非持久遊戲物件。
