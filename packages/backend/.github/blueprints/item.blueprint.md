# Item（物品）

## 語意級

### 系統概述

- 物品系統分類繁多，主題可拆分多套（暫定八套以上）。
- 物品內容：
  - 掉落池、原型（Template）、實例（Instance）、生成流程。
- 詞綴內容：
  - 掉落池、模板（AffixTemplate）、實例（AffixInstance）、生成流程。

## 架構級

### 物品原型（Item Template）

- 定義靜態數據與行為規則：
  - 名稱、類型、稀有度、裝備槽位、可否堆疊、可能詞綴、獨特效果。
- 設定檔（JSON）定義所有靜態屬性與詞綴列表。

### 物品實例（Item Instance）

- 真正放在倉庫/裝備身上的物品。
- 會序列化存入存檔，返序列化還原。

### 物品生成系統

1. **實例化系統**：解析數據定義，分離靜態與動態邏輯。
2. **詞綴生成系統**：隨機生成詞綴，定義模板（AffixTemplate）與詞綴池。
3. **生成流程**：
   - 藍圖載入與實例創建。
   - 數值隨機生成。
   - 處理特殊行為模組（詞綴影響戰鬥事件，不直接改屬性數值）。

## 代碼級

### 物品行為與屬性聚合

- 戰鬥或裝備時：
  - 監聽器觸發特殊效果。
  - 屬性聚合系統提取詞綴實例 (AffixInstance)，解析為 StatModifier，轉為戰鬥/面板數值。

### 資料快取與同步

- 若用 Redis，避免頻繁查詢慢速資料庫：
  - 玩家完整角色數據包存於快取。

### Relic & Equipment（遺物與裝備）

- 裝備和遺物在系統底層都被視為一種物品。
- 裝備有穿戴限制，每個 Slot 都只能一種。
- 遺物設計偏向疊屬性或疊機制（類似 Risk of Rain 2 的 item）。
- 裝備則能改變玩法或補足屬性。
