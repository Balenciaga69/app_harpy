# Inventory 模組規格說明

## 作者的話:

- 以下內容都是 AI 生成，我這邊說明一下

## 簡介

- 管理玩家倉庫、裝備槽位與遺物，負責裝備穿戴、卸下、購買、出售等操作。
- 支援無限倉庫、遺物堆疊、裝備唯一槽位、數據持久化與高效查詢。
- 與角色屬性面板、商店、事件系統高度整合。
- 最後更新時間：2025-12-14。

## 輸入與輸出

### 主要輸入

- 裝備/遺物實例（新增、穿戴、卸下、出售等操作的目標）
- 操作指令（如穿戴、卸下、排序、查詢等）
- 持久化資料（載入/儲存倉庫與裝備狀態）

### 主要輸出

- 當前倉庫內容（裝備、遺物清單）
- 當前裝備槽位狀態
- 操作結果（InventoryOperationResult，包含成功/失敗與更新後資料）
- 事件通知（如屬性面板需更新）

## 元件盤點

- Inventory：倉庫管理器，負責裝備與遺物的存取、查詢、排序與持久化。
- EquipmentSlots：裝備槽位管理，確保每類裝備唯一且正確穿戴/卸下。
- InventoryOperationResult：操作結果結構，回報每次操作的狀態與資料。
- 事件發射器：操作後發射事件，供 UI 或其他模組監聽。
- 整合 PersistentStorage：支援倉庫與裝備狀態的保存與載入。

## 模組依賴誰?或被誰依賴?

- 依賴：PersistentStorage（數據持久化）、Item（裝備/遺物定義與實例）、Character-Sheet（屬性面板計算，需通知其更新）
- 被依賴：Shop（購買/出售時操作倉庫）、CharacterManager（角色裝備管理）、UI（顯示倉庫與裝備狀態）

## 核心功能需求

- 倉庫管理：無數量限制，儲存所有裝備與遺物。
- 裝備槽位管理：每類裝備僅能穿戴一件，支援穿戴/卸下。
- 遺物堆疊：遺物可無限堆疊，穿戴時應用效果，卸下時移除。
- 數據變更處理：購買、出售、穿戴/卸下等操作後，更新角色與倉庫狀態。
- 事件發射：每次操作後發射事件，通知屬性面板與 UI。

## 進階需求

- 裝備驗證：確保裝備槽唯一性，避免重複穿戴。
- 遺物排序：支援遺物按類型或效果排序，便於管理。
- 數據持久化：整合 PersistentStorage，支援倉庫與裝備狀態的保存/載入。
- 效能優化：大量遺物時，提供查詢與過濾機制。
- 錯誤處理：處理無效操作（如槽位衝突），提供結構化錯誤。

## 介面需求

- Inventory：包含裝備列表、遺物列表、操作方法。
- EquipmentSlots：定義槽位類型與當前裝備。
- InventoryOperationResult：包含成功/失敗狀態與更新資料。

## 開發者的碎碎念

- 倉庫與裝備操作需高效且安全，避免資料競爭與狀態錯亂。
- 事件通知要即時，確保屬性面板與 UI 能正確反映最新狀態。
- 初期可先實作最小可行版本，後續再優化查詢與排序效能。
- 持久化與錯誤處理要完善，避免玩家資料遺失或異常。
