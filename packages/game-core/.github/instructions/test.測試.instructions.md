---
applyTo: '/*.test.ts, /*.spec.ts'
---

### 關於測試

- 測試是確保程式碼品質的關鍵，優先寫測試再開發（TDD），但專案初期可先實作再補測試。
- 測試檔案放在模組目錄下的 `__tests__/` 子目錄，命名為 `{模組名稱}.test.ts`。
- 使用 Jest 作為測試框架，支援 TypeScript 透過 `ts-jest`。

### 關於測試代碼

- 堅守原則
  - 測試應簡單、易讀，專注於驗證行為而非實作細節。
  - 每個測試獨立，避免共享狀態。
  - 使用 describe/it 結構組織測試，命名有意義。
  - Mock 外部依賴，測試純邏輯。
  - 測試覆蓋核心邏輯：建構子、方法、邊界條件、錯誤處理。
- 為了 AI 方便
  - 明確測試目標與預期結果。
  - 避免過度測試實作細節，專注公開行為。
  - 檔案大小限制：單一測試檔案不超過 200 行。
- 更佳實踐
  - 使用 AAA 模式（Arrange, Act, Assert）。
  - 測試異常情況與邊界值。
  - 整合測試時使用工具如 TestContainers，但單元測試優先 Mock。
  - 遵循專案代碼原則：低耦合、高內聚。
  - 如果寫測試 markdown，請以中文為主。
  - 偏好業界標準：Jest 斷言、Mock 函數等。
  - 測試命名使用通用語言，如 `should return correct value when input is valid`。
