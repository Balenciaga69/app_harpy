# Item-Generator 模組規格說明

## 簡介

Item-Generator 模組負責生成遊戲中的物品實例，包括裝備和遺物。模組採用協調器模式，將生成邏輯分解為專門的子生成器，並使用策略模式處理詞綴過濾。支援隨機種子確保生成可重現性，並根據難度係數動態調整裝備詞綴數量。最後更新時間：2025/12/10。

## 輸入與輸出

### 輸入

- 物品定義 ID（definitionId: string）：指定要生成的物品定義
- 難度係數（difficulty: number）：影響裝備詞綴數量和屬性範圍（僅裝備）
- 隨機種子（seed: string）：確保生成結果的可重現性（僅裝備）

### 輸出

- 裝備實例（IEquipmentInstance）：包含 ID、定義 ID、槽位、稀有度和詞綴列表的完整裝備物件
- 遺物實例（IRelicInstance）：包含 ID、定義 ID、稀有度和堆疊數量的遺物物件

## 元件盤點

### 協調器元件

- ItemGenerator：物品生成協調器，負責初始化子生成器並調度生成請求。

### 生成器元件

- EquipmentGenerator：裝備生成器，負責生成裝備實例，包括詞綴數量計算、詞綴過濾和詞綴擲骰。
- RelicGenerator：遺物生成器，負責生成遺物實例，處理堆疊邏輯。
- AffixGenerator：詞綴生成器，負責生成詞綴實例組合，使用隨機數生成器進行擲骰（目前未使用）。

### 工具元件

- AffixRoller：詞綴滾動器，負責根據詞綴定義生成隨機詞綴實例，支援權重隨機選取。

### 策略元件

- IAffixFilter：詞綴過濾策略介面，定義過濾邏輯契約。
- SlotBasedFilter：基於槽位的詞綴過濾策略，根據裝備槽位排除不適當的詞綴。

## 模組依賴誰?或被誰依賴?

### 依賴的模組

- domain/item：物品定義，依賴物品和詞綴定義、註冊表和介面
- seedrandom：隨機數生成庫，用於可重現隨機生成
- nanoid：ID 生成庫，用於生成唯一實例 ID

### 被依賴的模組

- logic/run：遊戲運行模組，依賴物品生成器創建敵人裝備
- logic/shop：商店模組，依賴物品生成器提供商品
- UI 層：物品顯示，依賴生成的物品實例進行介面渲染</content>
